// $('div').tooltip(); // calls the init method
// $('div').tooltip({  // calls the init method
//   foo : 'bar'
// });
// $('div').tooltip('hide'); // calls the hide method
// $('div').tooltip('update', 'This is the new tooltip content!'); // calls the update method
(function(e){var t={debug:!1,irisLoginAPI:"http://api.irislogin.it/",irisLogin:"http://irislogin.it/",images:{closeImage:"http://api.irislogin.it/public/img/btn-del-over-small.png",loaderBackImage:"http://api.irislogin.it/public/img/ajax-loader.gif"},scripts:{carouFredSel:"http://api.irislogin.it/public/js/jquery.carouFredSel.min.js",waitForImages:"http://api.irislogin.it/public/js/jquery.waitForImages.min.js"},galleries:[],websiteID:0,gallerySelected:0,startFrom:0,thumbs_visible:5,autoPlay:!1,wrapperID:!1,galleryID:"irislogin-gallery-",galleriesClass:"irislogin-galleries-wrapper",closeButtonID:!1,slideshowBackdropID:"slideshow-overall-backdrop",slideshowWrapperID:"slideshow-wrapper",slideshowCaruselID:"slideshow-carusel",slideshowThumbnailID:"slideshow-thumb"},n={init:function(r){var i=t=e.extend(t,r);i.websiteID!=0?e.when(e.getScript(i.scripts.carouFredSel),e.getScript(i.scripts.waitForImages),e.Deferred(function(t){e(t.resolve)})).done(e.ajax({url:i.irisLoginAPI+"gallery/"+i.websiteID+"?callback=?",type:"GET",dataType:"jsonp",success:function(e,r,i){if(e.result)n.build(e.data.galleries);else{alert("Galleries not loaded. Check console for more informations.");if(t.debug){console.log("IrisLoginGallery: ERROR malformed data received!");console.log(e)}}},error:function(e,n,r){document.console.log("IrisLoginGallery: ERROR while getting data.");if(t.debug){console.log(e);console.log(r)}}})):document.console.log("IrisLoginGallery: ERROR No website ID given.")},build:function(r,i){setup=e.extend(t,i);if(!setup.wrapperID){alert("Wrong Setup. Check console for more informations.");console.log("Wrapper ID Not set.")}else for(var s=r.length-1;s>=0;s--){var o=r[s],u=setup.galleryID+o.gid;wrapper=e("<DIV/>").attr({id:u,"class":"well"}).css({width:"90%","min-width":"350px","max-width":"1200px",margin:"50px auto"});wrapper.append(e("<h2/>").text(o.name).css("text-align","center"));gall=e("<div/>").attr({"class":setup.galleriesClass,"data-gid":o.gid}).css({"text-align":"center",margin:"20px 0px 0px 10px"});for(var a=o.images.length-1;a>=0;a--){imageData=o.images[a];img=e("<img/>").attr({"class":"gallery-image",title:imageData.title,alt:imageData.descr,src:setup.irisLogin+imageData.thumb,"data-large":setup.irisLogin+imageData.full_size,"data-gid":o.gid,"data-imgID":imageData.id}).bind("click",function(e){n.prepare(this.getAttribute("data-imgid"),this.getAttribute("data-gid"))}).css({display:"inline-block",border:"1px solid #ccc",padding:"12px",margin:"0px 20px 20px 0px"});gall.prepend(img)}wrapper.append(gall);wrapper.prependTo("#"+setup.wrapperID)}},prepare:function(r,i,s){setup=e.extend(t,s);var o=setup.galleryID+i,u=null,a=null,f=e("<div/>").attr({id:setup.slideshowBackdropID}).css({position:"fixed",top:0,left:0,width:"100%",height:"100%","min-height":e(window).height,"background-image":"url("+setup.images.loaderBackImage+")","background-repeat":"no-repeat","background-position":"center","background-color":"#FAFAFA","z-index":5e3,opacity:0}),l={position:{}};l.width=window.innerWidth*.8;l.height=window.innerHeight*.75;l.position.top=window.innerHeight/2-l.height/2;l.position.left=window.innerWidth/2-l.width/2;var c=e("<div/>").attr({id:setup.slideshowWrapperID}).css({position:"fixed",width:l.width,height:l.height,top:l.position.top,left:l.position.left,"background-color":"#000","box-shadow":"0 20px 50px #333","z-index":5500,overflow:"hidden",opacity:0});a=e("#"+o+" ."+setup.galleriesClass).clone().removeClass(setup.galleriesClass);a.attr({id:setup.slideshowThumbnailID,style:!1}).css({height:"120px",overflow:"hidden",position:"relative",bottom:"50px","min-width":"250px","z-index":6500}).find("img").each(function(){this.removeAttribute("data-large");this.removeAttribute("style");e(this).css({display:"block","float":"left",margin:"10px",width:"100px",height:"100px","box-shadow":"0 0 10px #000"})});u=e("#"+o+" ."+setup.galleriesClass).clone().removeClass(setup.galleriesClass);u.attr({id:setup.slideshowCaruselID,style:!1}).css({overflow:"hidden","z-index":6e3}).find("img").each(function(t){if(this.src){this.removeAttribute("style");this.setAttribute("width","auto");this.setAttribute("height",e("#"+setup.slideshowWrapperID).innerHeight());this.style.display="block";this.src=this.getAttribute("data-large");this.removeAttribute("data-large")}});c.append(u);c.append(a);a.children("img").click(function(){r=this.getAttribute("data-imgid");selector="#"+setup.slideshowCaruselID+" img[data-imgid="+r+"]";u.trigger("slideTo",[e(selector)])}).css("cursor","pointer");c.hover(function(){u.trigger("pause");a.parent().animate({bottom:"120"})},function(){u.trigger("play");a.parent().animate({bottom:"30"})});f.click(function(){n.destroy()});var h=e("<img/>").attr({src:setup.images.closeImage}).css({position:"fixed",top:l.position.top-15,left:l.position.left-15,"z-index":9e3}).bind("click",n.destroy).appendTo(c);setup.closeButtonID!=0&&e(setup.closeButtonID).bind("click",function(t){t.preventDefault();e(this).unbind("click");n.destroy()});e("body").append(f);e("body").append(c);f.animate({opacity:1},"fast");u.waitForImages({finished:function(){n.start(r,i,s)}})},start:function(n,r,i){setup=e.extend(t,i);var s=setup.galleryID+r,o=null,u=null,a={position:{}};a.width=window.innerWidth*.8;a.height=window.innerHeight*.75;a.position.top=window.innerHeight/2-a.height/2;a.position.left=window.innerWidth/2-a.width/2;o=e("#"+setup.slideshowCaruselID);u=e("#"+setup.slideshowThumbnailID);o.carouFredSel({width:"100%",height:"100%",items:{start:e("#"+setup.slideshowCaruselID+" img[data-imgid="+n+"]"),visible:1,height:a.height,width:"variable"},scroll:{fx:"crossfade",onBefore:function(t){n=t.items.visible.data("imgid");pos=Math.floor(setup.thumbs_visible/2)-1;u.trigger("slideTo",[e("#"+setup.slideshowThumbnailID+" img[data-imgid="+n+"]"),-pos])}},prev:{key:"left"},next:{key:"right"},onCreate:function(t){e("#"+setup.slideshowWrapperID).css({}).animate({opacity:1})}});u.carouFredSel({auto:!1,width:"100%"});setup.thumbs_visible=u.children("img").size();o.trigger("play",[0,!0])},stop:function(){e("#"+setup.slideshowCaruselID).trigger("stop");e("#"+setup.slideshowThumbnailID).trigger("stop")},update:function(t){e("#"+setup.slideshowCaruselID).trigger("updateSizes");e("#"+setup.slideshowThumbnailID).trigger("updateSizes")},destroy:function(r){setup=e.extend(t,r);var i=document.getElementById(setup.slideshowWrapperID),s=document.getElementById(setup.slideshowBackdropID);n.stop();e(i).animate({opacity:0},200);e(s).animate({opacity:0},200,function(){e("#"+setup.slideshowCaruselID).trigger("destroy");e("#"+setup.slideshowThumbnailID).trigger("destroy")});setTimeout(function(){i.parentNode.removeChild(i);s.parentNode.removeChild(s)},200)}};e.fn.irisLoginGallery=function(t){if(n[t])return n[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return n.init.apply(this,arguments);e.error("Method "+method+" does not exist on jQuery.irisLoginGallery")}})(jQuery);